PIC EQU 20H
EOI EQU 20H
TIMER EQU 10H
N_F10 EQU 10
N_CLK EQU 11
MASC_F10 EQU 11111110B
MASC_TIMER_F10 EQU 11111100B

ORG 40
IP_F10 DW RUT_F10

ORG 44
IP_TIMER DW RUT_TIMER

ORG 1000H 
SEG DB 30H
FINALL DB ?
SEGUNDOS DB 0
FINAL DB 60

ORG 3000H
RUT_TIMER: PUSH AX
INC SEG+1
CMP SEG+1, 3AH
JNZ RESET
MOV SEG+1, 30H
INC SEG
CMP SEG, 36H
JNZ RESET
MOV SEG, 30H
RESET: MOV AL, 0
OUT TIMER, AL
MOV AL, EOI
OUT EOI, AL
POP AX
IRET

ORG 4000H
RUT_F10: MOV BX, OFFSET SEG
MOV AL, 1
INT 7
CLI
MOV AL, MASC_F10
OUT PIC+1, AL
STI 
MOV AL, EOI
OUT EOI, AL
IRET

ORG 2000H
CLI
MOV AL, MASC_TIMER_F10
OUT PIC+1, AL 
MOV AL, N_F10
OUT PIC+4, AL
MOV AL, N_CLK
OUT PIC+5, AL
MOV AL, 1
OUT TIMER+1, AL
STI
LOOP: MOV CX, SEG
CMP CX, FINALL
JNZ LOOP

INT 0 
END
